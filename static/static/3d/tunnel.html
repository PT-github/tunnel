

<html>
<head>
<meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0,  initial-scale=1.0, user-scalable=no">
<title>H5-3d隧道演示</title>
</head>

<style type="text/css">
body{ 
margin:0;
padding: 0px;
position: fiexd;
}
</style>

<body>
<div id="gameIframeDiv" style="-webkit-overflow-scrolling:touch;width:100%;height:100%;padding:0;margin:0;border:0;overflow:hidden;position: absolute;">
    <iframe id="game_iframe" src="index.html" frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="no" width="100%" height="100%" ></iframe>
</div>

</body>

<script type="text/javascript">
	window.addEventListener("message", function(event){
		var revMsg = event.data;
		switch(revMsg.msgType){
			case "loaded": // 初始化完成，可以添加设备主体和设备
				var msg = {
					msgType:"loadTunnel", // 初始化隧道，横洞空洞数据必须一起带上
					msgData:{
						tunnelId:"a32932b8-7355-4de5-adf9-034075c89d2c", // 隧道id
						leftHoleLength:4056, // 左洞长度（米）
						rightHoleLength:4107, // 右洞长度（米）
						endStakeMark:710213,  // 左洞结束桩号（桩号米）
						endStakeMarkRight:710253, // 右洞结束桩号（桩号米）
						laneNums:3,  // 车道数（个）  
						startStakeMark:709157,  // 左洞开始桩号（桩号米） 
						startStakeMarkRight:709146,  // 右洞开始桩号（桩号米）
						leftHoleDirection: "岳阳方向", // 左洞方向 
						rightHoleDirection: "湘潭方向", // 右洞方向 
						singleDoubleType: 3, // 单双洞类型（1单右洞 2单左洞 3双洞）
					},
					
					// 附加的横洞空洞数据
					addData:[
						{
							id:"8e46993d-1a72-11eb-ab8a-11",
							emptyType:2, // 空洞类型（0空洞、1人行横洞、2车行横洞 3水泵房 4洞外配电房 5洞内配电房）
							length:30, // 长度
							pileNumber:709157 + 90, // 桩号 
							leftRightFlag:3, // 左右洞标识1 右洞 2 左洞 3 中间
							singleDoubleType:3, // 单双洞类型（1单右洞 2单左洞 3双洞）
						},
						{
							id:"8e46993d-1a72-11eb-ab8a-22",
							emptyType:1, // 空洞类型（0空洞、1人行横洞、2车行横洞 3水泵房 4洞外配电房 5洞内配电房）
							length:30, // 长度
							pileNumber:709157 + 40, // 桩号 
							leftRightFlag:3, // 左右洞标识1 右洞 2 左洞 3 中间
							singleDoubleType:3, // 单双洞类型（1单右洞 2单左洞 3双洞）
						},
						{
							id:"8e46993d-1a72-11eb-ab8a-33",
							emptyType:0, // 空洞类型（0空洞、1人行横洞、2车行横洞 3水泵房 4洞外配电房 5洞内配电房）
							length:60, // 长度
							pileNumber:709157 + 200, // 桩号 
							leftRightFlag:2, // 左右洞标识1 右洞 2 左洞 3 中间
							singleDoubleType:2, // 单双洞类型（1单右洞 2单左洞 3双洞）
						},
					], 
				}
				
				window.frames[0].postMessage(msg); // 初始化隧道
				
				////////////////////////////////////////////////////////////////////////
				// 测试消防器材
				for(var i =0; i < 10; ++i){
					var msg1 = {
						msgType:"addDevice",
						msgData:{
							id:"6703006a-9b93-4147-9e78-ef53483a2d8"+i, // 设备id
							deviceTypeCode:"conflagration", // 设备类型  火灾消防
							orientationLocation:0, //位置类型
							leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
							pileNumber:709160 + i *50,// 设备桩号
							deviceName:"火灾消防设备", // 设备名称
							deviceCommunicationsState:0, // 设备状态
							deviceCommunicationsStateName:"正常",// 设备状态描述
						}
					}
					window.frames[0].postMessage(msg1); // 添加设备
				}
				////////////////////////////////////////////////////////////////////////
				// 测试风机
				for(var i =0; i < 3; ++i){
					var msg2 = {
						msgType:"addDevice",
						msgData:{
							id:"1703006a-9b93-4147-9e78-2" + i, // 设备id
							deviceTypeCode:"draughtfan", // 设备类型  火灾消防
							orientationLocation:1 + i, //位置类型
							leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
							pileNumber:709152,// 设备桩号
							deviceName:"风机1", // 设备名称
							deviceCommunicationsState:i, // 设备状态
							deviceCommunicationsStateName:"正常",// 设备状态描述
						}
						}
						window.frames[0].postMessage(msg2); // 添加设备
					}

				////////////////////////////////////////////////////////////////////////
				// 测试情报板M
				var msg3 = {
					msgType:"addDevice",
					msgData:{
						id:"1703006a-9b93-4147-9e78-3", // 设备id
						deviceTypeCode:"intelligenceboard", // 设备类型  情报板
						deviceSubtypeCode:"M",  // 设备子类型  情报板M
						orientationLocation:0, //位置类型 情报板M位置固定居中 此参数无效
						leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
						pileNumber:709130,// 设备桩号
						deviceName:"情报板M", // 设备名称
						deviceCommunicationsState:0, // 设备状态
						deviceCommunicationsStateName:"正常",// 设备状态描述
						contentText:"道路千万条,安全第一条,行车不规范,亲人两行泪", // 显示文本
					}
				}
				window.frames[0].postMessage(msg3); // 添加设备

				////////////////////////////////////////////////////////////////////////
				// 测试情报板F
				var msg4 = {
					msgType:"addDevice",
					msgData:{
						id:"1703006a-9b93-4147-9e78-4", // 设备id
						deviceTypeCode:"intelligenceboard", // 设备类型  情报板
						deviceSubtypeCode:"F",  // 设备子类型  情报板F
						orientationLocation:0, //位置类型 情报板F位置固定靠右 此参数无效
						leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
						pileNumber:709120,// 设备桩号
						deviceName:"情报板M", // 设备名称
						deviceCommunicationsState:0, // 设备状态
						deviceCommunicationsStateName:"正常",// 设备状态描述
						contentText:"众志成城\n抗击疫情", // 显示文本
					}
				}
				window.frames[0].postMessage(msg4); // 添加设备
				////////////////////////////////////////////////////////////////////////
				// 照明灯
				var msg5 = {
						msgType:"addDevices",
						msgData:new Array(),
					}
				for(var i =0; i < 10; ++i){
					var data = {
							id:"1703006a-9b93-4147-9e78-5" + i, // 设备id
							deviceTypeCode:"lighting", // 设备类型  照明灯
							orientationLocation:0, //位置类型 照明灯应该只有0和10两种位置
							leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
							pileNumber:709160 + i * 5,// 设备桩号
							deviceName:"照明灯", // 设备名称
							deviceCommunicationsState: i%2, // 设备状态
							deviceCommunicationsStateName:"正常",// 设备状态描述
						}
					msg5.msgData.push(data);
				}
				window.frames[0].postMessage(msg5); // 添加设备
				////////////////////////////////////////////////////////////////////////
				// 照明灯回路
				var msg6 = {
					msgType:"addDevice",
					msgData:{
						id:"1703006a-9b93-4147-9e78-6", // 设备id
						deviceTypeCode:"lightingloop", // 设备类型  照明灯
						orientationLocation:10, //位置类型 照明灯应该只有0和10两种位置
						leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
						pileNumber:709170,// 设备桩号
						deviceName:"照明灯回路", // 设备名称
						deviceCommunicationsState:0, // 设备状态
						deviceCommunicationsStateName:"正常",// 设备状态描述
					}
				}
				window.frames[0].postMessage(msg6); // 添加设备

				////////////////////////////////////////////////////////////////////////
				// 车道指示器
				for(var i =0; i < 3; ++i){
					var msg7 = {
						msgType:"addDevice",
						msgData:{
							id:"1703006a-9b93-4147-9e78-7" + i, // 设备id
							deviceTypeCode:"laneIndicator", // 设备类型  照明灯
							orientationLocation:1 + i, //位置类型 
							leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
							pileNumber:709138,// 设备桩号
							deviceName:"指示器", // 设备名称
							deviceCommunicationsState:2, // 设备状态
							deviceCommunicationsStateName:"正常",// 设备状态描述
						}
					}
					window.frames[0].postMessage(msg7); // 添加设备
				}
				
				////////////////////////////////////////////////////////////////////////
				// 信号灯
				for(var i =0; i < 2; ++i){
					var msg8 = {
						msgType:"addDevice",
						msgData:{
							id:"1703006a-9b93-4147-9e78-8" + i, // 设备id
							deviceTypeCode:"signallamp", // 设备类型  信号灯
							orientationLocation:1, //位置类型 
							leftRightFlag:1+i,// 左右洞标识（1右洞，2左洞）
							pileNumber:709137,// 设备桩号
							deviceName:"信号灯", // 设备名称
							deviceCommunicationsState:0 +i, // 设备状态
							deviceCommunicationsStateName:"正常",// 设备状态描述
						}
					}
					window.frames[0].postMessage(msg8); // 添加设备
				}
				
				////////////////////////////////////////////////////////////////////////
				// 卷闸门
				var msg9 = {
					msgType:"addDevices",
					msgData:new Array(),
				}
				// 右洞卷闸门
				msg9.msgData.push({
					id:"1703006a-9b93-4147-9e78-91", // 设备id
					deviceTypeCode:"tunneldoor", // 设备类型  卷闸门
					orientationLocation:18, //位置类型
					leftRightFlag:1,// 左右洞标识（1右洞，2左洞）
					pileNumber:709157 + 90,// 设备桩号 必须和对应的横洞一致
					deviceName:"卷闸门", // 设备名称
					deviceCommunicationsState: 2, // 设备状态
					deviceCommunicationsStateName:"正常",// 设备状态描述
				});
				// 左洞卷闸门
				msg9.msgData.push({
					id:"1703006a-9b93-4147-9e78-92", // 设备id
					deviceTypeCode:"tunneldoor", // 设备类型  卷闸门
					orientationLocation:16, //位置类型
					leftRightFlag:2,// 左右洞标识（1右洞，2左洞）
					pileNumber:709157 + 90,// 设备桩号 必须和对应的横洞一致
					deviceName:"卷闸门", // 设备名称
					deviceCommunicationsState: 1, // 设备状态
					deviceCommunicationsStateName:"正常",// 设备状态描述
				});
				// 横洞中的灯
				msg9.msgData.push({
					id:"1703006a-9b93-4147-9e78-93" + 1, // 设备id
					deviceTypeCode:"lightingloop", // 设备类型  卷闸门
					orientationLocation:17, //位置类型
					leftRightFlag:2,// 左右洞标识（1右洞，2左洞）
					pileNumber:709157 + 90,// 设备桩号 必须和对应的横洞一致
					deviceName:"6连灯", // 设备名称
					deviceCommunicationsState: 1, // 设备状态
					deviceCommunicationsStateName:"正常",// 设备状态描述
				});
				window.frames[0].postMessage(msg9); // 添加设备
			break;
			
			case "clickDevice": // 点击选择某设备
				console.log("click device:" + revMsg.msgData);
			break;
		}
	});
	
</script>
</html>

