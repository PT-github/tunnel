!function(){"use strict";class t extends Laya.Script3D{constructor(){super(),this._albedoColor=new Laya.Vector4(.6,.6,.6,1),this._defaultX=7,this._camerOffsetHeight=5,this._camerOffsetDis=10,this._camerLookHeight=0}changeData(t){}onAwake(){this.nodeSprite=this.owner.parent;let t=0;if(this.nodeSprite.DeviceData){switch(this.nodeSprite.DeviceData.orientationLocation){case 0:t=-this._defaultX;break;case 10:t=this._defaultX;break;case 1:case 2:case 3:t=this.nodeSprite.tunnelSprite.getRoadPosX(this.nodeSprite.DeviceData.orientationLocation)}switch(this.nodeSprite.DeviceData.orientationLocation){case 0:case 10:1==this.nodeSprite.tunnelSprite.posType&&(t=-t),t<0&&this.nodeSprite.transform.rotate(new Laya.Vector3(0,180,0),!0,!1)}}0!=t&&(this.nodeSprite.transform.localPosition.x=t,this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition)}onMouseClick(){this.cameraMoveToLook()}cameraMoveToLook(){let e=t.TEMP_CAMERA_POS;this.nodeSprite.transform.getForward(e),e.x*=-this._camerOffsetDis,e.y*=this._camerOffsetDis,e.z*=-this._camerOffsetDis,e.y+=this._camerOffsetHeight,Laya.Vector3.add(this.nodeSprite.transform.position,e,e),this.nodeSprite.transform.position.cloneTo(m.CameraScript.curLookPos),m.CameraScript.curLookPos.y+=this._camerLookHeight,m.CameraScript.tweenMoveTo(e,500,null,m.CameraScript.curLookPos);let s=this.nodeSprite.name;if(this.nodeSprite.DeviceData){s=JSON.stringify(this.nodeSprite.DeviceData);let t={msgType:"clickDevice",msgData:this.nodeSprite.DeviceData};Laya.Browser.window.parent.postMessage(t)}p.instance.textSelect.text="当前选中："+s}onUpdate(){}onMouseEnter(){this.showSelectEffect(!0)}onMouseOut(){this.showSelectEffect(!1)}showSelectEffect(t){t?this.setSubMaterialAttr(this.owner,"albedoColor",this._albedoColor):this.setSubMaterialAttr(this.owner,"albedoColor")}setSubMaterialAttr(t,e,s=null,a=null){if(a||(a=e+"_back"),t instanceof Laya.MeshSprite3D){let i=t.meshRenderer.material;i[a]||(i[a]=i[e]),i[e]=s||i[a]}for(let i=0;i<t.numChildren;++i)this.setSubMaterialAttr(t.getChildAt(i),e,s,a)}}t.TEMP_CAMERA_POS=new Laya.Vector3(0,1,0);class e{constructor(){}}e.DEVICE_TYPE_QB_BOARD=1,e.DEVICE_TYPE_QB_BOARD_F=2,e.DEVICE_TYPE_DRAUGHT=3,e.DEVICE_TYPE_LIGHT01=4,e.DEVICE_TYPE_ALERTOR=5,e.DEVICE_TYPE_PHONE=6,e.DEVICE_TYPE_LIGHT_GRUOP=7,e.DEVICE_TYPE_SIGNAL_LAMP=8,e.DEVICE_TYPE_SIGNAL_indicator=9,e.DEVICE_TYPE_TEXT_DIS=100;class s extends Laya.Sprite3D{constructor(t,e=null){super(),this._roadID=0,this._nodeType=0,this._defaultLength=5,this._showLength=50,this._lastNode=e,e&&(e._nextNode=this),this._nodeType=t;let s="sd_suidao01";switch(t){case 0:break;case 1:s="sd_rukou01",this._defaultLength=35,this.showLength=this._defaultLength;break;case 2:s="sd_rukou01",this._defaultLength=36.4,this.showLength=this._defaultLength;break;case 3:break;case 4:s="sd_suidao02"}Laya.Sprite3D.load("res/LayaScene_suidao/Conventional/"+s+".lh",Laya.Handler.create(this,this.loadMeshEnd)),this.name=s}loadMeshEnd(t){switch(t.transform.position.toDefault(),t.transform.localPosition.toDefault(),this._meshNode=Laya.Sprite3D.instantiate(t,this),this._meshNode.transform.localScale.setValue(1,1,1),this._meshNode.transform.localPosition.toDefault(),this._nodeType){case 1:this._meshNode.transform.localPosition.setValue(.47,5.23,0);break;case 2:this._meshNode.transform.localPosition.setValue(-.4,5.23,0),this._meshNode.transform.rotate(new Laya.Vector3(0,0,180),!0,!1);break;case 4:case 0:this.setSubMaterialAttr(this._meshNode.getChildByName("sd_dimian003")),this.setSubMaterialAttr(this._meshNode.getChildByName("sd_qiangbi011")),this.setSubMaterialAttr(this._meshNode.getChildByName("sd_qiangbi012"))}this._meshNode.transform.localScale=this._meshNode.transform.localScale,this._meshNode.transform.localPosition=this._meshNode.transform.localPosition}get showLength(){return this._showLength}set showLength(t){this._showLength=t;let e=t/this._defaultLength;this.transform.localScale.z=e,this.transform.localScale=this.transform.localScale;let s=-t/2;this._lastNode?s+=this._lastNode.getNextNodePos():s+=t,this.transform.localPosition.z=s,0!=this._roadID&&(this.transform.localPosition.x=-50*this._roadID),this.transform.localPosition=this.transform.localPosition}getNextNodePos(){return this.transform.localPosition.z-this._showLength/2}setSubMaterialAttr(t){if(t){if(t instanceof Laya.MeshSprite3D){t.meshRenderer.material.tilingOffsetX=this._showLength/this._defaultLength}for(let e=0;e<t.numChildren;++e)this.setSubMaterialAttr(t.getChildAt(e))}}}class a extends t{constructor(){super()}onAwake(){this._defaultX=7,super.onAwake()}onStart(){this._camerOffsetDis=5,this._camerOffsetHeight=0,this.nodeSprite.transform.localPosition.y=2.1,this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition,this.nodeSprite.transform.rotate(new Laya.Vector3(0,-90,0),!0,!1)}}class i{static createText3D(t,e=50,s="rgb(240,0,0)",a="宋体"){let i=t.split(/[\n]/),o=0,n=i.length;i.forEach(t=>{let s=t.replace(/[\u0391-\uFFE5]/g,"aa").length/2*(e+2);o=Math.max(s,o)});let r=o;r=Math.max(r,3*e);let h=Laya.Browser.createElement("canvas");var l=h.getContext("2d");h.width=r,h.height=e*n,l.fillStyle=s,l.font="bold "+e+"px "+a,l.textAlign="left",l.textBaseline="top";for(let t=0;t<n;++t)l.fillText(i[t],0,t*e);let c=new Laya.Texture2D(128,128);return c.loadImageSource(h),Laya.Browser.removeElement(h),c}}class o extends t{constructor(){super()}onStart(){if(this.meshsp=this.owner,this.meshsp.transform.localPosition.y=.3,this.meshsp.transform.localPosition=this.meshsp.transform.localPosition,this.nodeSprite.showData)this.nodeSprite.DeviceData||(this.meshsp.transform.localScale=new Laya.Vector3(1,1,.35)),this.setText(this.nodeSprite.showData,"宋体");else{let t=-this.meshsp.parent.transform.localPosition.z;this.setText(t+"M","宋体");let e=this.meshsp.parent;e.transform.localPosition=e.transform.localPosition}1==this.nodeSprite.tunnelSprite.posType&&this.meshsp.transform.rotate(new Laya.Vector3(0,180,0),!0,!1)}setText(t,e){let s=i.createText3D(t,50,"rgb(240,240,240)",e);this.meshsp.meshRenderer.material.texture=s}}class n extends t{constructor(){super(),this._rotateType=0}onStart(){super.onAwake(),this._camerOffsetHeight=.5,this._fengshanMesh=this.owner.getChildByName("sd_wj_sd_fengji01_02"),this.nodeSprite.transform.localPosition.y=7,this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition,this._rotateType=2,this.updateState()}onUpdate(){if(super.onUpdate(),this._fengshanMesh)switch(this._rotateType){case 1:this._fengshanMesh.transform.rotate(n.ROTATE_TYPE_VALUE_1);break;case 2:this._fengshanMesh.transform.rotate(n.ROTATE_TYPE_VALUE_2)}}updateState(){this._rotateType=this.nodeSprite.DeviceData.deviceCommunicationsState}changeData(t){super.changeData(t),this.updateState()}}n.ROTATE_TYPE_VALUE_1=new Laya.Vector3(0,.1,0),n.ROTATE_TYPE_VALUE_2=new Laya.Vector3(0,-.1,0);class r extends t{constructor(){super()}onAwake(){this._defaultX=4,super.onAwake()}onStart(){super.onStart(),this._camerOffsetDis=5,this._camerOffsetHeight=0,this.nodeSprite.transform.localPosition.y=7,this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition,this.nodeSprite.transform.rotate(new Laya.Vector3(0,-90,0),!0,!1),this.changeData()}setOpen(t){let e=this.owner.getChildByName("sd_dadeng02");e.getChildAt(0).active=t;let s=e.meshRenderer.material;s.colorA=t?1:.1}changeData(){this.setOpen(1==this.nodeSprite.DeviceData.deviceCommunicationsState)}}class h extends t{constructor(){super()}onAwake(){this._defaultX=7,super.onAwake()}onStart(){this._camerOffsetDis=5,this._camerOffsetHeight=0,this.nodeSprite.transform.localPosition.y=3.2,this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition,this.nodeSprite.transform.rotate(new Laya.Vector3(0,-90,0),!0,!1),this.changeData()}setOpen(t){let e=this.owner;for(let s=0;s<6;s++){let a=e.getChildAt(s),i=a.getChildAt(0),o=a.getChildAt(1);i.active=t,o.active=!t}}changeData(){this.setOpen(1==this.nodeSprite.DeviceData.deviceCommunicationsState)}}class l extends t{constructor(){super()}onStart(){super.onAwake(),this._camerOffsetHeight=15,this._camerLookHeight=4;let t=this.nodeSprite.transform.localPositionZ<-10;if(this.nodeSprite.deviceType==e.DEVICE_TYPE_QB_BOARD_F)this.nodeSprite.transform.localPosition.x=8.6,this.showText(this.nodeSprite.DeviceData.contentText,50),t&&(this.nodeSprite.transform.localPosition.x=7.6);else{let t=this.owner;t.transform.localPosition.y=9.28,t.transform.localPosition=t.transform.localPosition,this.nodeSprite.transform.localPosition.x=0,this.showText(this.nodeSprite.DeviceData.contentText,50)}t&&(this.nodeSprite.transform.localPosition.x=-this.nodeSprite.transform.localPosition.x,this.nodeSprite.transform.rotate(new Laya.Vector3(0,180,0),!0,!1)),this.nodeSprite.transform.localPosition=this.nodeSprite.transform.localPosition}showText(t,e){let s=this.owner.getChildAt(0),a=s.getComponent(Laya.Animator),o=i.createText3D(t,50,"rgb(250,0,0)","Microsoft YaHei");if(s.meshRenderer.material.texture=o,a){let e=t.replace(/[\u0391-\uFFE5]/g,"aa").length;a.speed=10/e}}}class c extends Laya.Sprite3D{constructor(t){switch(super(),this._deviceType=t,this._deviceType){case e.DEVICE_TYPE_QB_BOARD:this.loadItem("sd_qingbaoban02");break;case e.DEVICE_TYPE_QB_BOARD_F:this.loadItem("sd_qingbaoban01");break;case e.DEVICE_TYPE_DRAUGHT:this.loadItem("sd_wj_sd_fengji01");break;case e.DEVICE_TYPE_LIGHT01:this.loadItem("sd_dadeng01");break;case e.DEVICE_TYPE_TEXT_DIS:this.loadItem("textdis");break;case e.DEVICE_TYPE_ALERTOR:this.loadItem("sd_huozhaijingbao01");break;case e.DEVICE_TYPE_PHONE:this.loadItem("sd_dianhuaguangbo01");break;case e.DEVICE_TYPE_LIGHT_GRUOP:this.loadItem("dengzu01")}}loadItem(t){Laya.Sprite3D.load("res/LayaScene_suidao/Conventional/"+t+".lh",Laya.Handler.create(this,this.loadMeshEnd)),this.name=t}get tunnelSprite(){return this.parent}get deviceType(){return this._deviceType}getDeviceScirpt(){let e=this.getChildAt(0);return e?e.getComponent(t):null}loadMeshEnd(t){t.transform.position.toDefault(),t.transform.localPosition.toDefault();let s=Laya.Sprite3D.instantiate(t,this);switch(s.transform.localPosition.toDefault(),s.transform.localPosition=s.transform.localPosition,this._deviceType){case e.DEVICE_TYPE_QB_BOARD_F:case e.DEVICE_TYPE_QB_BOARD:s.addComponent(l);break;case e.DEVICE_TYPE_DRAUGHT:s.addComponent(n);break;case e.DEVICE_TYPE_LIGHT01:s.addComponent(r);break;case e.DEVICE_TYPE_TEXT_DIS:s.addComponent(o);break;case e.DEVICE_TYPE_ALERTOR:case e.DEVICE_TYPE_PHONE:s.addComponent(a);break;case e.DEVICE_TYPE_LIGHT_GRUOP:s.addComponent(h)}}get DeviceData(){return this._deviceData}changeData(t){this._deviceData=t;let e=this.getDeviceScirpt();e&&e.changeData(t)}get showData(){return this._showData}changeShowData(t){this._showData=t;let e=this.getDeviceScirpt();e&&e.changeData(t)}}class d extends Laya.Sprite3D{constructor(){super(),this.TunnelLength=200,this._posType=0,this.RoadCount=3,this._nodeList=new Array,this._startMark=0,this._disText="方向显示"}get posType(){return this._posType}set startMark(t){this._startMark=t}get startMark(){return this._startMark}getRoadPosX(t){let e=0;switch(t){case 1:e=-3.7;break;case 2:break;case 3:e=3.8}return 1==this.posType&&(e=-e),e}init(t,a){this.TunnelLength=t,this._posType=a,this.name="TunnelSprite"+this._posType;let i=Math.floor(this.TunnelLength/100)+1;for(let t=0;t<i;++t){this.addChild(new c(e.DEVICE_TYPE_TEXT_DIS)).transform.localPosition.z=-100*t}let o=new s(1);this.addChild(o);let n=new s(0,o);n.showLength=this.TunnelLength,this.addChild(n);let r=new s(2,n);this.addChild(r),this._nodeList.push(o,n,r),this.transform.localPosition.x=-30*a,this.transform.localPosition=this.transform.localPosition}addDevice(t){let s=t.pileNumber-this.startMark,a=0;switch(t.deviceTypeCode){case"signallamp":case"laneIndicator":break;case"urgentphone":a=e.DEVICE_TYPE_PHONE;break;case"controller":break;case"broadcast":a=e.DEVICE_TYPE_PHONE;break;case"conflagration":a=e.DEVICE_TYPE_ALERTOR;break;case"guidelight":break;case"lighting":a=e.DEVICE_TYPE_LIGHT01;break;case"lightingloop":a=e.DEVICE_TYPE_LIGHT_GRUOP;break;case"waterlevel":case"electronicfence":case"environment":case"tunneldoor":break;case"draughtfan":a=e.DEVICE_TYPE_DRAUGHT;break;case"video":break;case"intelligenceboard":switch(t.deviceSubtypeCode){case"M":a=e.DEVICE_TYPE_QB_BOARD;break;case"F":a=e.DEVICE_TYPE_QB_BOARD_F}}if(0==a)return null;let i=this.addChild(new c(a));return i.changeData(t),i.transform.localPosition.z=-s,i}setDirText(t){this._disText=t+"->->";let s=this.addChild(new c(e.DEVICE_TYPE_TEXT_DIS));s.changeShowData(this._disText),0==this._posType?s.transform.localPosition.setValue(15,-1,20):s.transform.localPosition.setValue(-15,-1,20),s.transform.localPosition=s.transform.localPosition;let a=Math.floor(this.TunnelLength/250)+1;for(let t=1;t<a;++t){let s=this.addChild(new c(e.DEVICE_TYPE_TEXT_DIS));s.changeShowData(this._disText),s.changeData(!0),s.transform.localPosition.z=-10-250*t,s.transform.localPosition=s.transform.localPosition}}getViewPos(){let e=this._nodeList[0];m.CameraScript.autoViewIndex++,m.CameraScript.autoViewIndex>1&&(m.CameraScript.autoViewIndex=0,e=this._nodeList[this._nodeList.length-1]);let s=e.getChildAt(0).getChildByName("view"),a=t.TEMP_CAMERA_POS;a.x=0,a.y=0,a.z=3,a.y+=2,Laya.Vector3.add(s.transform.position,a,a),s.transform.position.cloneTo(m.CameraScript.curLookPos),m.CameraScript.curLookPos.y+=2;let i=Laya.Vector3.distance(a,m.GameCamera.transform.position);m.CameraScript.tweenMoveTo(a,100*i,null,m.CameraScript.curLookPos)}}class m{}m.tunnelMgr=new class{constructor(){this.TunnelCount=2,this._deviceList=new Map}init(t){}loadTunnel(t){this.InitData=t;let e=new d;m.GameScene.addChild(e),e.RoadCount=t.laneNums,e.init(t.leftHoleLength,1),e.setDirText(t.leftHoleDirection),e.startMark=t.startStakeMark,this._leftTunnelSprite=e;let s=new d;m.GameScene.addChild(s),s.RoadCount=t.laneNums,s.init(t.rightHoleLength,0),s.setDirText(t.rightHoleDirection),s.startMark=t.startStakeMarkRight,this._rightTunnelSprite=s}findDevice(t){return this._deviceList[t]}addDevice(t){let e=this.findDevice(t.id);e?e.changeData(t):(e=1==t.leftRightFlag?this._rightTunnelSprite.addDevice(t):this._leftTunnelSprite.addDevice(t),this._deviceList[t.id]=e)}addDevices(t){for(let e=0;e<t.length;++e)this.addDevice(t[e])}};var u,_=Laya.Scene,g=Laya.ClassUtils.regClass;!function(t){!function(t){class e extends _{constructor(){super()}createChildren(){super.createChildren(),this.loadScene("test/TestScene")}}t.TestSceneUI=e,g("ui.test.TestSceneUI",e)}(t.test||(t.test={}))}(u||(u={}));class p extends u.test.TestSceneUI{constructor(){super(),p.instance=this,this.btnReset.on(Laya.Event.CLICK,this,this.onClickReset),this.btnAutoView.on(Laya.Event.CLICK,this,this.onClickAutoView)}onClickReset(){m.CameraScript.reset(),this.textSelect.text="当前选中：无"}onClickAutoView(){m.GameScene.getChildByName("TunnelSprite0").getViewPos()}onChangeLenth(t){m.GameScene.getChildByName("TunnelSprite1")}}class f{constructor(){}static init(){(0,Laya.ClassUtils.regClass)("script/GameUI.ts",p)}}f.width=1920,f.height=1080,f.scaleMode="fixedwidth",f.screenMode="none",f.alignV="middle",f.alignH="center",f.startScene="test/TestScene.scene",f.sceneRoot="",f.debug=!1,f.stat=!0,f.physicsDebug=!1,f.exportSceneToJson=!0,f.init();class D extends Laya.Script3D{constructor(){super(),this._initCamerPos=new Laya.Vector3,this._initCamerDir=new Laya.Quaternion,this._moveing=!1,this.curLookPos=new Laya.Vector3,this.autoViewIndex=0}reset(){this.curLookPos.setValue(0,0,0),this.tweenMoveTo(this._initCamerPos,500,this._initCamerDir)}onAwake(){this.camera=this.owner}onStart(){this.camera.transform.position.cloneTo(this._initCamerPos),this.camera.transform.rotation.cloneTo(this._initCamerDir)}tweenMoveTo(t,e,s=null,a=null){let i=this.camera.transform.position;if(this._moveing=!0,Laya.Tween.clearAll(i),Laya.Tween.to(i,{x:t.x,y:t.y,z:t.z,update:new Laya.Handler(this,function(){this.camera.transform.position=i,a&&this.camera.transform.lookAt(a,D.UP_V3,!1)})},e,null,Laya.Handler.create(this,this.moveOver)),!a&&s){let t=this.camera.transform.rotation;Laya.Tween.clearAll(t),Laya.Tween.to(t,{x:s.x,y:s.y,z:s.z,w:s.w,update:new Laya.Handler(this,function(){this.camera.transform.rotation=t})},e)}}moveOver(){this._moveing=!1}}D.UP_V3=new Laya.Vector3(0,1,0);var L=Laya.Vector3,S=Laya.Quaternion;class E extends D{constructor(){super(),this.canRotation_X=!0,this.canRotation_Y=!0,this.canScale=!0,this.AroundPos=new L,this.mouseSettings=new y(0,.3,.3),this.angleRange=new T(-360,360),this.distanceRange=new T(1,80),this.damper=5,this.CurrentAngles=new L,this.CurrentAnglesTemp=new L,this.targetAngles=new L,this.moveV3=new Laya.Vector3,this.FORWORD=new L,this.deltaWheel=0,this.lastMouseX=0,this.lastMouseY=0,this.mouseRunning=!1,this.tempRotationZ=new S,this.tempV=new L,this.tempV1=new L}onStart(){super.onStart(),m.CameraScript=this,this.initTransform(),Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.mouseDown),Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.mouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.mouseUp),Laya.stage.on(Laya.Event.MOUSE_WHEEL,this,this.mouseWheel),Laya.stage.on(Laya.Event.RIGHT_MOUSE_DOWN,this,this.rightMouseDown),Laya.stage.on(Laya.Event.RIGHT_MOUSE_UP,this,this.rightMouseUp)}initTransform(){this.transform=this.camera.transform,this.CurrentAngles.setValue(-this.transform.rotationEuler.x,this.transform.rotationEuler.y,this.transform.rotationEuler.z),this.targetAngles.setValue(-this.transform.rotationEuler.x,this.transform.rotationEuler.y,this.transform.rotationEuler.z),this.curLookPos?this.curLookPos.cloneTo(this.AroundPos):this.AroundPos.setValue(0,0,0),this.CurrentDistance=L.distance(this.transform.position,this.AroundPos),this.targetDistance=L.distance(this.transform.position,this.AroundPos)}moveOver(){super.moveOver(),this.initTransform()}onUpdate(){if(this._moveing)return;this.AroundByMouseInput(),this.canRotation_X||(this.targetAngles.y=0),this.canRotation_Y||(this.targetAngles.x=0);let t=this.GetAxisX,e=this.GetAxisY;if(this.bRightMouseDown){let s=this.transform.rotationEuler.y/180*Math.PI,a=Math.sin(s),i=Math.cos(s),o=2*this.deltaTime;this.moveV3.z=-(e*i-t*a)*o,this.moveV3.x=-(e*a+t*i)*o,this.transform.translate(this.moveV3,!1),Laya.Vector3.add(this.AroundPos,this.moveV3,this.AroundPos),Laya.Vector3.add(this.curLookPos,this.moveV3,this.curLookPos)}else this.CurrentAngles=this.LerpVector3(this.CurrentAngles,this.targetAngles,this.deltaTime*this.damper),this.CurrentDistance=this.LerpNum(this.CurrentDistance,this.targetDistance,this.deltaTime*this.damper),this.CurrentAnglesTemp.x=-this.CurrentAngles.x,this.CurrentAnglesTemp.y=this.CurrentAngles.y,this.CurrentAnglesTemp.z=this.CurrentAngles.z,this.transform.rotationEuler=this.CurrentAnglesTemp,L.scale(this.GetForward,this.CurrentDistance,this.tempV),L.subtract(this.AroundPos,this.tempV,this.tempV1),this.transform.position=this.tempV1;this.lastMouseX=Laya.stage.mouseX,this.lastMouseY=Laya.stage.mouseY}get GetAxisX(){return Laya.stage.mouseX-this.lastMouseX}get GetAxisY(){return Laya.stage.mouseY-this.lastMouseY}get deltaTime(){return Laya.timer.delta/1e3}get GetForward(){return this.transform.getForward(this.FORWORD),this.FORWORD}mouseDown(t){t.target.parent==Laya.Scene.root&&(this.mouseRunning=!0)}mouseMove(t){this.myevent=t}mouseWheel(t){this.deltaWheel=t.delta}mouseUp(t){this.mouseRunning=!1}rightMouseDown(t){this.bRightMouseDown=!0}rightMouseUp(t){this.lastMouseX=Laya.stage.mouseX,this.lastMouseY=Laya.stage.mouseY,this.bRightMouseDown=!1,this.initTransform()}Clamp(t,e,s){return t<e?e:t>s?s:t}LerpVector3(t,e,s){var a=new L;return a.x=t.x+s*(e.x-t.x),a.y=t.y+s*(e.y-t.y),a.z=t.z+s*(e.z-t.z),a}LerpNum(t,e,s){return t+s*(e-t)}AroundByMouseInput(){this.mouseRunning&&(this.targetAngles.y-=this.GetAxisX*this.mouseSettings.pointerSensitivity,this.targetAngles.x+=this.GetAxisY*this.mouseSettings.pointerSensitivity,this.targetAngles.x=this.Clamp(this.targetAngles.x,this.angleRange.min,this.angleRange.max)),this.canScale&&(this.targetDistance-=this.deltaWheel*this.mouseSettings.wheelSensitivity,this.deltaWheel=0,this.targetDistance=this.Clamp(this.targetDistance,this.distanceRange.min,this.distanceRange.max))}}class y{constructor(t,e,s){this.mouseButtonID=t,this.pointerSensitivity=e,this.wheelSensitivity=s}}class T{constructor(t,e){this.min=t,this.max=e}}new class{constructor(){let t=new Config3D;t.isAntialias=!1,window.Laya3D?Laya3D.init(f.width,f.height,t):Laya.init(f.width,f.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=f.scaleMode,Laya.stage.screenMode=f.screenMode,Laya.stage.alignV=f.alignV,Laya.stage.alignH=f.alignH,Laya.URL.exportSceneToJson=f.exportSceneToJson,(f.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),f.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),f.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){Laya.Scene3D.load("res/LayaScene_suidao/Conventional/suidao.ls",Laya.Handler.create(this,this.onLoadScene))}onLoadScene(t){if(Laya.stage.addChild(t),m.GameScene=t,m.GameCamera=t.getChildByName("Main Camera"),m.GameCamera.addComponent(E),m.tunnelMgr.init(t),f.startScene&&Laya.Scene.open(f.startScene),Laya.Browser.window.addEventListener("message",function(t){let e=t.data;switch(e.msgType){case"loadTunnel":m.tunnelMgr.loadTunnel(e.msgData);break;case"addDevice":m.tunnelMgr.addDevice(e.msgData);break;case"addDevices":m.tunnelMgr.addDevices(e.msgData)}}),Laya.Browser.window.parent){let t={msgType:"loaded"};Laya.Browser.window.parent.postMessage(t)}}}}();